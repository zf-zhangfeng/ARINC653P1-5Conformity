- theory BasicLems
- imports ["../Services_R/HealthMonitor"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/HealthMonitor)
          ["../Services_R/InterCom"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/InterCom)
          ["../Services_R/IntraCom"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/IntraCom)
          ["../Services_R/Partition"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/Partition)
          ["../Services_R/Process"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/Process)
          ["../Services_R/Time"](https://zf-zhangfeng.github.io/ARINC653P1-5Conformity/Services_R/Time)

<html>
<head>
<title>BasicLems.thy</title>
</head>
<body bgcolor="#ffffff">



<pre><font color="#333333"><span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   1 </font></span><font color="#006699"><strong>theory</strong></font> BasicLems
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   2 </font></span><font color="#009966"><strong>imports</strong></font> <font color="#ff00cc">&quot;../Services_R/HealthMonitor&quot;</font> <font color="#ff00cc">&quot;../Services_R/InterCom&quot;</font> <font color="#ff00cc">&quot;../Services_R/IntraCom&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   3 </font></span>        <font color="#ff00cc">&quot;../Services_R/Partition&quot;</font> <font color="#ff00cc">&quot;../Services_R/Process&quot;</font> <font color="#ff00cc">&quot;../Services_R/Time&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   4 </font></span><font color="#009966"><strong>begin</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">   5 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   6 </font></span><font color="#006699"><strong>section</strong></font><font color="#6600cc">&lsaquo;</font><font color="#6600cc">L</font><font color="#6600cc">e</font><font color="#6600cc">m</font><font color="#6600cc">m</font><font color="#6600cc">a</font><font color="#6600cc">s</font><font color="#6600cc"> </font><font color="#6600cc">f</font><font color="#6600cc">o</font><font color="#6600cc">r</font><font color="#6600cc"> </font><font color="#6600cc">B</font><font color="#6600cc">a</font><font color="#6600cc">s</font><font color="#6600cc">i</font><font color="#6600cc">c</font><font color="#6600cc"> </font><font color="#6600cc">P</font><font color="#6600cc">r</font><font color="#6600cc">o</font><font color="#6600cc">p</font><font color="#6600cc">e</font><font color="#6600cc">r</font><font color="#6600cc">i</font><font color="#6600cc">t</font><font color="#6600cc">e</font><font color="#6600cc">s</font><font color="#6600cc">&rsaquo;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   7 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   8 </font></span><font color="#cc0000">(*scheduler*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   9 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  10 </font></span><font color="#006699"><strong>lemma</strong></font> getPrio_sd<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getPriority (schedule_Abs s core_id) (part_id, proc_id) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  11 </font></span><font color="#ff00cc">      getPriority s (part_id, proc_id)&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  12 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getPriority_def schedule_Abs_def
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  13 </font></span>  <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis <font color="#000000"><strong>(</strong></font>no_types<font color="#000000"><strong>,</strong></font> lifting<font color="#000000"><strong>)</strong></font> PROCS_STATE_TYPE.select_convs<font color="#000000"><strong>(</strong></font>3<font color="#000000"><strong>)</strong></font> PROCS_STATE_TYPE.surjective PROCS_STATE_TYPE.update_convs<font color="#000000"><strong>(</strong></font>2<font color="#000000"><strong>)</strong></font> StaProc_sched.select_convs<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font> StaProc_sched.surjective StaProc_sched.update_convs<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  14 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  15 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_sd<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (schedule_Abs s core_id) pp =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  16 </font></span><font color="#ff00cc">      getCntxt s pp&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  17 </font></span>  <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  18 </font></span>    <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;getCntxt (schedule_Abs s core_id) pp = </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  19 </font></span><font color="#ff00cc">        procCntxt(rscPendProcs_'  (let t = timer_' s; newPartID = schedPart core_id (int t);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  20 </font></span><font color="#ff00cc">      f_readyQ = readyQue (partitions_' s); newPartID = schedPart core_id (int t);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  21 </font></span><font color="#ff00cc">      f_procSta = procSta (procs_' s); f_curProc = curProc (partitions_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  22 </font></span><font color="#ff00cc">      sched_proc_newPart = schedProc_Abs f_readyQ newPartID f_procSta f_curProc in </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  23 </font></span><font color="#ff00cc">  s&#10631;partitions_' := (partitions_' s)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  24 </font></span><font color="#ff00cc">      &#10631;curPart := (curPart(partitions_' s))(core_id := Some newPartID),</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  25 </font></span><font color="#ff00cc">      curProc := (curProc (partitions_' s))(newPartID := Some (snd(snd sched_proc_newPart))),</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  26 </font></span><font color="#ff00cc">      readyQue := fst sched_proc_newPart&#10632;,</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  27 </font></span><font color="#ff00cc">    procs_' := (procs_' s)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  28 </font></span><font color="#ff00cc">      &#10631;procSta := setProcSta' (fst (snd sched_proc_newPart)) (newPartID, (snd(snd sched_proc_newPart))) RUNNING&#10632;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  29 </font></span><font color="#ff00cc">    &#10632;)) pp&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  30 </font></span>      <font color="#006699"><strong>unfolding</strong></font> schedule_Abs_def getCntxt_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  31 </font></span>     <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (schedule_Abs s core_id) pp = </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  32 </font></span><font color="#ff00cc">        procCntxt(  (let t = timer_' s; newPartID = schedPart core_id (int t);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  33 </font></span><font color="#ff00cc">      f_readyQ = readyQue (partitions_' s); newPartID = schedPart core_id (int t);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  34 </font></span><font color="#ff00cc">      f_procSta = procSta (procs_' s); f_curProc = curProc (partitions_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  35 </font></span><font color="#ff00cc">      sched_proc_newPart = schedProc_Abs f_readyQ newPartID f_procSta f_curProc in </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  36 </font></span><font color="#ff00cc">  rscPendProcs_'(s&#10631;partitions_' := (partitions_' s)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  37 </font></span><font color="#ff00cc">      &#10631;curPart := (curPart(partitions_' s))(core_id := Some newPartID),</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  38 </font></span><font color="#ff00cc">      curProc := (curProc (partitions_' s))(newPartID := Some (snd(snd sched_proc_newPart))),</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  39 </font></span><font color="#ff00cc">      readyQue := fst sched_proc_newPart&#10632;,</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  40 </font></span><font color="#ff00cc">    procs_' := (procs_' s)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  41 </font></span><font color="#ff00cc">      &#10631;procSta := setProcSta' (fst (snd sched_proc_newPart)) (newPartID, (snd(snd sched_proc_newPart))) RUNNING&#10632;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  42 </font></span><font color="#ff00cc">    &#10632;))) pp&quot;</font> <font color="#006699"><strong>by</strong></font> metis
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  43 </font></span>     <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (schedule_Abs s core_id) pp = </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  44 </font></span><font color="#ff00cc">        procCntxt(rscPendProcs_' s) pp&quot;</font>  <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  45 </font></span>     <font color="#0099ff"><strong>thus</strong></font> ?thesis <font color="#006699"><strong>unfolding</strong></font> getCntxt_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  46 </font></span>  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  47 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  48 </font></span><font color="#006699"><strong>lemma</strong></font> getddl_sd<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getProcDDL (schedule_Abs s core_id) (part_id, proc_id) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  49 </font></span><font color="#ff00cc">      getProcDDL s (part_id, proc_id)&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  50 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getProcDDL_def schedule_Abs_def
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  51 </font></span>  <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis <font color="#000000"><strong>(</strong></font>no_types<font color="#000000"><strong>,</strong></font> lifting<font color="#000000"><strong>)</strong></font> PROCS_STATE_TYPE.select_convs<font color="#000000"><strong>(</strong></font>4<font color="#000000"><strong>)</strong></font> PROCS_STATE_TYPE.surjective PROCS_STATE_TYPE.update_convs<font color="#000000"><strong>(</strong></font>2<font color="#000000"><strong>)</strong></font> StaProc.surjective StaProc_sched.select_convs<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font> StaProc_sched.update_convs<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  52 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  53 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  54 </font></span><font color="#cc0000">(*cntx*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  55 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  56 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_rst_None<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (resetCntxt s pp) pp = None&quot;</font> <font color="#006699"><strong>unfolding</strong></font> getCntxt_def resetCntxt_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  57 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  58 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_Alone<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  59 </font></span><font color="#ff00cc">      getCntxt s pp1&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  60 </font></span><font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  61 </font></span>  <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  62 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_' (let proc_id_sta = procSta (procs_' s) pp in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  63 </font></span><font color="#ff00cc">  case proc_id_sta of </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  64 </font></span><font color="#ff00cc">      Some READY &rArr; readyDel_s_D s (fst pp) (snd pp) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  65 </font></span><font color="#ff00cc">      Some WAITING &rArr; if isInWaitQ s pp then waitDel_D s pp</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  66 </font></span><font color="#ff00cc">                      else s |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  67 </font></span><font color="#ff00cc">      _ &rArr; s) )pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  68 </font></span>    <font color="#006699"><strong>unfolding</strong></font> getCntxt_def procAlone_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  69 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  70 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_'</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  71 </font></span><font color="#ff00cc">      (let proc_id_sta = procSta (procs_' s) pp in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  72 </font></span><font color="#ff00cc">  case proc_id_sta of </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  73 </font></span><font color="#ff00cc">      Some READY &rArr; (let ll = the ((readyQue(partitions_' s)) (fst pp)); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  74 </font></span><font color="#ff00cc">      proc_priority = the((curPriority(procs_' s)) ((fst pp), (snd pp))) in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  75 </font></span><font color="#ff00cc">  s&#10631;partitions_' := (partitions_' s)&#10631;readyQue := readyDel_D (readyQue(partitions_' s)) (fst pp) proc_priority (snd pp)&#10632;&#10632;)    |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  76 </font></span><font color="#ff00cc">      Some WAITING &rArr; if isInWaitQ s pp then (let cid = the (procBlngCore pp); vpwl = waitQue (cores_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  77 </font></span><font color="#ff00cc">    pd = waitDiff(rscPendProcs_' s); new_vp_pd = waitQ_SuspQDel vpwl pd cid pp  in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  78 </font></span><font color="#ff00cc">  s&#10631;cores_' := (cores_' s)&#10631;waitQue := fst new_vp_pd&#10632;,</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  79 </font></span><font color="#ff00cc">    rscPendProcs_' := (rscPendProcs_' s)&#10631;waitDiff := snd new_vp_pd&#10632;&#10632;)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  80 </font></span><font color="#ff00cc">                      else s |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  81 </font></span><font color="#ff00cc">      _ &rArr; s) </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  82 </font></span><font color="#ff00cc">      )pp1&quot;</font> <font color="#006699"><strong>unfolding</strong></font> readyDel_s_D_def waitDel_D_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  83 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  84 </font></span><font color="#ff00cc">      (let proc_id_sta = procSta (procs_' s) pp in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  85 </font></span><font color="#ff00cc">  case proc_id_sta of </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  86 </font></span><font color="#ff00cc">      Some READY &rArr; (let ll = the ((readyQue(partitions_' s)) (fst pp)); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  87 </font></span><font color="#ff00cc">      proc_priority = the((curPriority(procs_' s)) ((fst pp), (snd pp))) in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  88 </font></span><font color="#ff00cc">  procCntxt(rscPendProcs_' (s&#10631;partitions_' := (partitions_' s)&#10631;readyQue := readyDel_D (readyQue(partitions_' s)) (fst pp) proc_priority (snd pp)&#10632;&#10632;)))    |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  89 </font></span><font color="#ff00cc">      Some WAITING &rArr; if isInWaitQ s pp then (let cid = the (procBlngCore pp); vpwl = waitQue (cores_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  90 </font></span><font color="#ff00cc">       pd = waitDiff(rscPendProcs_' s); new_vp_pd = waitQ_SuspQDel vpwl pd cid pp  in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  91 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_'(s&#10631;cores_' := (cores_' s)&#10631;waitQue := fst new_vp_pd&#10632;,</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  92 </font></span><font color="#ff00cc">      rscPendProcs_' := (rscPendProcs_' s)&#10631;waitDiff := snd new_vp_pd&#10632;&#10632;)))</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  93 </font></span><font color="#ff00cc">                      else procCntxt(rscPendProcs_' s) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  94 </font></span><font color="#ff00cc">      _ &rArr; procCntxt(rscPendProcs_' s) </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  95 </font></span><font color="#ff00cc">      )pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  96 </font></span>    <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>smt <font color="#000000"><strong>(</strong></font>z3<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.exhaust PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>21<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>22<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>23<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>24<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>25<font color="#000000"><strong>)</strong></font> option.case_eq_if<font color="#000000"><strong>)</strong></font>  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  97 </font></span>   <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  98 </font></span><font color="#ff00cc">      (let proc_id_sta = procSta (procs_' s) pp in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  99 </font></span><font color="#ff00cc">  case proc_id_sta of </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 100 </font></span><font color="#ff00cc">      Some READY &rArr; (let ll = the ((readyQue(partitions_' s)) (fst pp)); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 101 </font></span><font color="#ff00cc">      proc_priority = the((curPriority(procs_' s)) ((fst pp), (snd pp))) in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 102 </font></span><font color="#ff00cc">  procCntxt(rscPendProcs_' s))    |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 103 </font></span><font color="#ff00cc">      Some WAITING &rArr; if isInWaitQ s pp then (let cid = the (procBlngCore pp); vpwl = waitQue (cores_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 104 </font></span><font color="#ff00cc">       pd = waitDiff(rscPendProcs_' s); new_vp_pd = waitQ_SuspQDel vpwl pd cid pp  in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 105 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_'(s&#10631;cores_' := (cores_' s)&#10631;waitQue := fst new_vp_pd&#10632;,</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 106 </font></span><font color="#ff00cc">      rscPendProcs_' := (rscPendProcs_' s)&#10631;waitDiff := snd new_vp_pd&#10632;&#10632;)))</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 107 </font></span><font color="#ff00cc">                      else procCntxt(rscPendProcs_' s) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 108 </font></span><font color="#ff00cc">      _ &rArr; procCntxt(rscPendProcs_' s) </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 109 </font></span><font color="#ff00cc">      )pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 110 </font></span>     <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>smt <font color="#000000"><strong>(</strong></font>z3<font color="#000000"><strong>)</strong></font> StaPart_Sched.update_convs<font color="#000000"><strong>(</strong></font>2<font color="#000000"><strong>)</strong></font> StaProc.simps<font color="#000000"><strong>(</strong></font>3<font color="#000000"><strong>)</strong></font> StaProc.surjective<font color="#000000"><strong>)</strong></font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 111 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 112 </font></span><font color="#ff00cc">      (let proc_id_sta = procSta (procs_' s) pp in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 113 </font></span><font color="#ff00cc">  case proc_id_sta of </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 114 </font></span><font color="#ff00cc">      Some READY &rArr; (let ll = the ((readyQue(partitions_' s)) (fst pp)); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 115 </font></span><font color="#ff00cc">      proc_priority = the((curPriority(procs_' s)) ((fst pp), (snd pp))) in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 116 </font></span><font color="#ff00cc">  procCntxt(rscPendProcs_' s))    |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 117 </font></span><font color="#ff00cc">      Some WAITING &rArr; if isInWaitQ s pp then (let cid = the (procBlngCore pp); vpwl = waitQue (cores_' s); </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 118 </font></span><font color="#ff00cc">       pd = waitDiff(rscPendProcs_' s); new_vp_pd = waitQ_SuspQDel vpwl pd cid pp  in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 119 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_' s))</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 120 </font></span><font color="#ff00cc">                      else procCntxt(rscPendProcs_' s) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 121 </font></span><font color="#ff00cc">      _ &rArr; procCntxt(rscPendProcs_' s) </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 122 </font></span><font color="#ff00cc">      )pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 123 </font></span>    <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis PROCS_STATE_PENDING_TYPE.select_convs<font color="#000000"><strong>(</strong></font>7<font color="#000000"><strong>)</strong></font> PROCS_STATE_PENDING_TYPE.surjective PROCS_STATE_PENDING_TYPE.update_convs<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font> StaProc.simps<font color="#000000"><strong>(</strong></font>3<font color="#000000"><strong>)</strong></font> StaProc.simps<font color="#000000"><strong>(</strong></font>7<font color="#000000"><strong>)</strong></font> StaProc.surjective<font color="#000000"><strong>)</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 124 </font></span>  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 125 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (procAlone s pp) pp1 =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 126 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_' s)pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 127 </font></span>    <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>smt <font color="#000000"><strong>(</strong></font>z3<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.exhaust PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>21<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>22<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>23<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>24<font color="#000000"><strong>)</strong></font> PROC_STATE_TYPE.simps<font color="#000000"><strong>(</strong></font>25<font color="#000000"><strong>)</strong></font> option.case_eq_if<font color="#000000"><strong>)</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 128 </font></span>     <font color="#0099ff"><strong>thus</strong></font> ?thesis
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 129 </font></span>    <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis <font color="#000000"><strong>(</strong></font>no_types<font color="#000000"><strong>,</strong></font> lifting<font color="#000000"><strong>)</strong></font> getCntxt_def<font color="#000000"><strong>)</strong></font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 130 </font></span><font color="#006699"><strong>qed</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 131 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 132 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 133 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_rdyAdd<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (readyAdd s (part_id0, proc_id0)) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 134 </font></span><font color="#ff00cc">      getCntxt s (part_id1, proc_id1)&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 135 </font></span><font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 136 </font></span>  <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;getCntxt (readyAdd s (part_id0, proc_id0)) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 137 </font></span><font color="#ff00cc">      procCntxt(rscPendProcs_' (let f_readyQue = readyQue(partitions_' s); part_id = fst (part_id0, proc_id0); proc_id = snd (part_id0, proc_id0);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 138 </font></span><font color="#ff00cc">      prio = the(getPriority s (part_id0, proc_id0)); f_readyQue' = readyAddTail_D f_readyQue part_id prio proc_id in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 139 </font></span><font color="#ff00cc">  s&#10631;partitions_' := (partitions_' s)&#10631;readyQue := f_readyQue'&#10632;&#10632;))(part_id1, proc_id1)&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 140 </font></span>    <font color="#006699"><strong>unfolding</strong></font> getCntxt_def readyAdd_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 141 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (readyAdd s (part_id0, proc_id0)) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 142 </font></span><font color="#ff00cc">      procCntxt( let f_readyQue = readyQue(partitions_' s); part_id = fst (part_id0, proc_id0); proc_id = snd (part_id0, proc_id0);</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 143 </font></span><font color="#ff00cc">      prio = the(getPriority s (part_id0, proc_id0)); f_readyQue' = readyAddTail_D f_readyQue part_id prio proc_id in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 144 </font></span><font color="#ff00cc">  rscPendProcs_' (s&#10631;partitions_' := (partitions_' s)&#10631;readyQue := f_readyQue'&#10632;&#10632;)) (part_id1, proc_id1)&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 145 </font></span>    <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 146 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (readyAdd s (part_id0, proc_id0)) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 147 </font></span><font color="#ff00cc">        procCntxt(rscPendProcs_' s)(part_id1, proc_id1)&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 148 </font></span>   <font color="#0099ff"><strong>thus</strong></font> ?thesis <font color="#006699"><strong>unfolding</strong></font> getCntxt_def  <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 149 </font></span><font color="#006699"><strong>qed</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 150 </font></span>  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 151 </font></span>   
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 152 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 153 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_setSta<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (setProcSta s (part_id0, proc_id0) sta) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 154 </font></span><font color="#ff00cc">      getCntxt s (part_id1, proc_id1)&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 155 </font></span>  <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 156 </font></span>  <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;getCntxt (setProcSta s (part_id0, proc_id0) sta) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 157 </font></span><font color="#ff00cc">    procCntxt(rscPendProcs_' (s&#10631;procs_' := (procs_' s) &#10631;procSta := (procSta (procs_' s))((part_id0, proc_id0) := Some sta)&#10632;&#10632;))(part_id1, proc_id1)&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 158 </font></span>    <font color="#006699"><strong>unfolding</strong></font> getCntxt_def setProcSta_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 159 </font></span>  <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getCntxt (setProcSta s (part_id0, proc_id0) sta) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 160 </font></span><font color="#ff00cc">        procCntxt(rscPendProcs_' s)(part_id1, proc_id1)&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 161 </font></span>  <font color="#0099ff"><strong>thus</strong></font> ?thesis <font color="#006699"><strong>unfolding</strong></font> getCntxt_def  <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 162 </font></span><font color="#006699"><strong>qed</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 163 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 164 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_procRdy<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (procReady s pp) pp = getCntxt s pp&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 165 </font></span>        <font color="#006699"><strong>unfolding</strong></font> getCntxt_def procReady_def 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 166 </font></span>        <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis getCntxt_def getCtx_Alone getCtx_rdyAdd getCtx_setSta surj_pair<font color="#000000"><strong>)</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 167 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 168 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_petDdl<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (setProcDDL s (part_id0, proc_id0) t) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 169 </font></span><font color="#ff00cc">      getCntxt s (part_id1, proc_id1)&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 170 </font></span>  <font color="#006699"><strong>unfolding</strong></font> setProcDDL_def getCntxt_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 171 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 172 </font></span><font color="#006699"><strong>lemma</strong></font> getCtx_petrls<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getCntxt (setRlsPoint s (part_id0, proc_id0) t) (part_id1, proc_id1) =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 173 </font></span><font color="#ff00cc">      getCntxt s (part_id1, proc_id1)&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 174 </font></span>  <font color="#006699"><strong>unfolding</strong></font> setRlsPoint_def getCntxt_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 175 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 176 </font></span><font color="#cc0000">(*ddl*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 177 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 178 </font></span><font color="#006699"><strong>lemma</strong></font> getddl_set_NotNone <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getProcDDL (setProcDDL s pp t) pp &ne; None&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 179 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getProcDDL_def setProcDDL_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 180 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 181 </font></span><font color="#cc0000">(*rls*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 182 </font></span><font color="#006699"><strong>lemma</strong></font> getfrls_set_NotNone <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getRlsPoint (setRlsPoint s pp t) pp &ne; None&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 183 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getRlsPoint_def setRlsPoint_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 184 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 185 </font></span><font color="#006699"><strong>lemma</strong></font> getfrls_setddl <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getRlsPoint (setProcDDL s pp t) pp1 = getRlsPoint s pp1&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 186 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getRlsPoint_def setProcDDL_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 187 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 188 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 189 </font></span><font color="#cc0000">(*proc sta*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 190 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 191 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 192 </font></span><font color="#006699"><strong>lemma</strong></font> getSta_setddl<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getProcSta (setProcDDL s pp t) pp1 = getProcSta s pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 193 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getProcSta_def setProcDDL_def <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 194 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 195 </font></span><font color="#006699"><strong>lemma</strong></font> getSta_setrls<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getProcSta (setRlsPoint s pp t) pp1 = getProcSta s pp1&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 196 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getProcSta_def setRlsPoint_def <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 197 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 198 </font></span><font color="#006699"><strong>lemma</strong></font> getSta_set_Waiting<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getProcSta (setProcSta s p WAITING) p = Some WAITING&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 199 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getProcSta_def setProcSta_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 200 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 201 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 202 </font></span><font color="#006699"><strong>lemma</strong></font> prioritySame<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;proc_priority. </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 203 </font></span><font color="#ff00cc">  let tt = (the ((readyQue(partitions_' s)) part_id))!proc_priority in</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 204 </font></span><font color="#ff00cc">  (readyQue(partitions_' s)) part_id &ne; None &and; tt &ne; [] &#10230; </font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 205 </font></span><font color="#ff00cc">  (&forall;i&lt;length tt. getPriority s (part_id, tt!i) = Some proc_priority)&quot;</font> <font color="#006699"><strong>sorry</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 206 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 207 </font></span><font color="#cc0000">(*process_FT*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 208 </font></span><font color="#cc0000">(*wait_diff*)</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 209 </font></span><font color="#006699"><strong>lemma</strong></font> getWaitDiff_setWaitDiff_NotNone<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getWaitDiff (setWaitDiff s pp t) pp &ne; None&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 210 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getWaitDiff_def setWaitDiff_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 211 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 212 </font></span><font color="#006699"><strong>lemma</strong></font> getWaitDiff_setCntxt_Eq<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getWaitDiff (setCntxt s rsc qq) pp = getWaitDiff s pp&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 213 </font></span>  <font color="#006699"><strong>unfolding</strong></font> getWaitDiff_def setWaitDiff_def
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 214 </font></span>  <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> setCntxt_def<font color="#000000"><strong>)</strong></font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 215 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 216 </font></span><font color="#006699"><strong>lemma</strong></font> getWaitDiff_rscQPush_Eq<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;getWaitDiff s qq = getWaitDiff (rscQPush s rsc pp) qq&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 217 </font></span>  <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 218 </font></span>    <font color="#006699"><strong>let</strong></font> ?f_rscPendProcs_' <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">&quot;rscPendProcs_' s&quot;</font> <font color="#006699"><strong>let</strong></font> ?f_rscQue <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">&quot;rscQue ?f_rscPendProcs_'&quot;</font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 219 </font></span>    <font color="#006699"><strong>let</strong></font> ?f_curPriority <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">&quot;curPriority (procs_' s)&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 220 </font></span>    <font color="#006699"><strong>let</strong></font> ?rsc_id_que <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">&quot;rscQue ?f_rscPendProcs_' rsc&quot;</font> <font color="#006699"><strong>let</strong></font> ?disp <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">&quot;getRscQDis s rsc&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 221 </font></span>    <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;getWaitDiff (rscQPush s rsc pp) qq =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 222 </font></span><font color="#ff00cc">       waitDiff(rscPendProcs_' (case rsc of</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 223 </font></span><font color="#ff00cc">    bbd _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632;&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 224 </font></span><font color="#ff00cc">    evt _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632;&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 225 </font></span><font color="#ff00cc"> interC _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 226 </font></span><font color="#ff00cc">    buf _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 227 </font></span><font color="#ff00cc">   sema _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 228 </font></span><font color="#ff00cc">userPlMtx _ &rArr; s&#10631;rscPendProcs_' := ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;&#10632;)) qq&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 229 </font></span>    <font color="#006699"><strong>unfolding</strong></font> rscQPush_def Let_def getWaitDiff_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 230 </font></span>    <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getWaitDiff (rscQPush s rsc pp) qq =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 231 </font></span><font color="#ff00cc">       waitDiff( (case rsc of</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 232 </font></span><font color="#ff00cc">    bbd _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 233 </font></span><font color="#ff00cc">    evt _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 234 </font></span><font color="#ff00cc"> interC _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 235 </font></span><font color="#ff00cc">    buf _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 236 </font></span><font color="#ff00cc">   sema _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632; |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 237 </font></span><font color="#ff00cc">userPlMtx _ &rArr; ?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;)) qq&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 238 </font></span>      <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>cases rsc<font color="#000000"><strong>)</strong></font>  <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 239 </font></span>    <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getWaitDiff (rscQPush s rsc pp) qq =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 240 </font></span><font color="#ff00cc">       ( (case rsc of</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 241 </font></span><font color="#ff00cc">    bbd _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632;) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 242 </font></span><font color="#ff00cc">    evt _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO ?f_rscQue rsc pp&#10632;) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 243 </font></span><font color="#ff00cc"> interC _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 244 </font></span><font color="#ff00cc">    buf _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 245 </font></span><font color="#ff00cc">   sema _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;) |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 246 </font></span><font color="#ff00cc">userPlMtx _ &rArr; waitDiff(?f_rscPendProcs_'&#10631;rscQue := addList_FIFO_Prio ?f_rscQue ?f_curPriority rsc pp ?disp&#10632;))) qq&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 247 </font></span>    <font color="#006699"><strong>using</strong></font> option.case_eq_if
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 248 </font></span>    <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>smt <font color="#000000"><strong>(</strong></font>verit<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.exhaust RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>37<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>38<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>39<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>40<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>41<font color="#000000"><strong>)</strong></font> RESRC_ID_TYPE.simps<font color="#000000"><strong>(</strong></font>42<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>)</strong></font> 
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 249 </font></span>  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 250 </font></span>    <font color="#006699"><strong>hence</strong></font> <font color="#ff00cc">&quot;getWaitDiff (rscQPush s rsc pp) qq =</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 251 </font></span><font color="#ff00cc">       ( (case rsc of</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 252 </font></span><font color="#ff00cc">    bbd _ &rArr; waitDiff(?f_rscPendProcs_') |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 253 </font></span><font color="#ff00cc">    evt _ &rArr; waitDiff(?f_rscPendProcs_') |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 254 </font></span><font color="#ff00cc"> interC _ &rArr; waitDiff(?f_rscPendProcs_') |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 255 </font></span><font color="#ff00cc">    buf _ &rArr; waitDiff(?f_rscPendProcs_') |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 256 </font></span><font color="#ff00cc">   sema _ &rArr; waitDiff(?f_rscPendProcs_') |</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 257 </font></span><font color="#ff00cc">userPlMtx _ &rArr; waitDiff(?f_rscPendProcs_'))) qq&quot;</font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 258 </font></span>      <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>cases rsc<font color="#000000"><strong>)</strong></font>  <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 259 </font></span>      <font color="#0099ff"><strong>thus</strong></font> ?thesis <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>cases rsc<font color="#000000"><strong>)</strong></font> <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> getWaitDiff_def<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>+</strong></font>  
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 260 </font></span>  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 261 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 262 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 263 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 264 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 265 </font></span>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 266 </font></span><font color="#009966"><strong>end</strong></font>
<span style="background:#ffffffff; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 267 </font></span>
</font></pre>
</body>
</html>
